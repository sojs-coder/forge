# AnimatedSprite

**Extends:** [Renderer](./Renderer.md)

The `AnimatedSprite` component renders an animated sprite from a spritesheet. It requires a JSON file (typically generated by a tool like TexturePacker) that defines the frames and animations.

## Constructor

`new AnimatedSprite({ spritesheet, spritesheetImage, width, height, startingAnimation, disableAntiAliasing, onAnimationComplete, webEngine })`

-   `spritesheet: string`
    The path to the JSON file that defines the spritesheet data.

-   `spritesheetImage?: string`
    The path to the image file for the spritesheet.

-   `width: number`
    The width of the sprite.

-   `height: number`
    The height of the sprite.

-   `startingAnimation?: string`
    The name of the animation to play when the sprite is created.

-   `disableAntiAliasing?: boolean`
    If `true`, disables anti-aliasing for this sprite. Defaults to `false`.

-   `onAnimationComplete?: (animationName: string, sprite: AnimatedSprite) => void`
    A callback function that is called when an animation completes.

-   `webEngine?: boolean`
    This property is used internally by the engine and should not be modified.

## Properties

-   `spritesheet: string`
    The path to the JSON data for the spritesheet.

-   `spritesheetData?: SpriteSheetData`
    The parsed spritesheet data.

-   `loadedSheet?: HTMLImageElement`
    The image element for the spritesheet.

-   `frames: Record<string, HTMLImageElement[]>`
    A dictionary of all the frames for each animation.

-   `currentFrameIndex: number`
    The index of the current frame in the current animation.

-   `width: number` & `height: number`
    The dimensions of the sprite.

-   `bouncing: boolean`
    A flag to indicate if the sprite animation is in reverse (bouncing).

-   `currentAnimation: string`
    The name of the animation that is currently playing.

-   `disableAntiAliasing: boolean`
    If `true`, disables anti-aliasing for this sprite.

-   `onAnimationComplete?: (animationName: string, sprite: AnimatedSprite) => void`
    A callback function that is called when an animation completes.

## Methods

-   `setAnimation(animationName: string, { loop, bounce }: { loop?: boolean, bounce?: boolean } = {})`
    Changes the current animation.

## Spritesheet Format

The engine expects a specific JSON format for the spritesheet data. See the `convertTexturePackerToSpriteSheetData` helper function and the `SpriteSheetData` type in the source code for details.

## Examples

### Creating an Animated Sprite

```javascript
import { GameObject } from './Parts/GameObject';
import { Transform } from './Parts/Children/Transform';
import { AnimatedSprite } from './Parts/Children/AnimatedSprite';
import { Vector } from './Math/Vector';

const monster = new GameObject({ name: 'Monster' });

monster.addChildren(
    new Transform({ position: new Vector(400, 300) }),
    new AnimatedSprite({
        spritesheet: './assets/monster.json', // Path to the JSON data
        spritesheetImage: './assets/monster.png', // Path to the image
        width: 32,
        height: 32,
        startingAnimation: 'walk'
    })
);

myLayer.addChild(monster);
```

### Controlling Animations from another Part

This example shows a script that changes the monster's animation based on its state.

```javascript
import { Part } from './Parts/Part';
import { AnimatedSprite } from './Parts/Children/AnimatedSprite';

class MonsterAI extends Part {
    constructor() {
        super();
        this.name = 'MonsterAI';
        this.isAngry = false;
    }

    act() {
        const animator = this.sibling<AnimatedSprite>('AnimatedSprite');
        if (!animator) return;

        // If the monster is angry and not already playing the attack animation...
        if (this.isAngry && animator.currentAnimation !== 'attack') {
            animator.setAnimation('attack');
        } else if (!this.isAngry && animator.currentAnimation !== 'walk') {
            animator.setAnimation('walk');
        }
    }
}

// Add the AI to the monster GameObject
monster.addChild(new MonsterAI());
```